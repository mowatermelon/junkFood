<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="BigShowYwjgQueryMapper">
	<resultMap id="BaseResultMap" type="java.util.Map"></resultMap>
		<!--big ywjg 首页-->
	<select id="queryYCZLForIndex" resultMap="BaseResultMap" parameterType="java.util.Map">
		 select * from (select ycdm, count(*) value
           from bdcdj_check t
          where 1 = 1  
          <if test="cityCode!=null and cityCode!=null">
         	  and (t.qxdm=#{cityCode}  or pqxdm=#{cityCode} )
          </if>
          <if test = "starttime!=null and starttime!='' and endtime !=null and endtime!=''">
		        and t.sjrksj between to_date(#{starttime}, 'YYYY-MM-DD') and to_date(#{endtime}, 'YYYY-MM-DD')
		 </if>
          group by ycdm) pivot(sum(value) for ycdm in(201,202,203,204,205))
	</select>
</mapper>